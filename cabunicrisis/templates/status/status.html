{% extends 'base.html' %}
{% load static %}

{% block content %}
<main role="main">

	<div class="jumbotron" style="background:transparent url('{% static 'images/jejuni-3.jpg' %}') no-repeat center center /cover; border-radius: 0">

		<div class="container text-center">
			<h1 class="text-white display-3">Job Status</h1>
			<p class="text-white">Bioinformatics tasks usually take more than a blink of an eye. That's why cabunicrisis manages jobs and lets you check their status</p>
			<br>
			<h4 class="text-white">Please enter your Email or UUID associated with your job.</h4>
			<br>
			<form method="post" enctype="multipart/form-data" class="text-center">
				{% csrf_token %}
				<div class="row">
					<button type="button" class="btn text-white btn-outline-warning btn-lg col-md-5 p-3">
						<div class="row align-items-center"> 
							<div class="col-md-7">
								<input type="email" name="email" class="form-control">
							</div>
							<div class="col-md-5">
								<h5><b>Email Address</b></h5>
							</div>
						</div>
					</button>
					<div class="col-md-2"><h5 class="text-white">OR</h5></div>
					<button type="button" class="btn text-white btn-outline-warning btn-lg col-md-5 p-3">
						<div class="row align-items-center"> 
							<div class="col-md-8">
								<input type="text" name="uuid" class="form-control">
							</div>
							<div class="col-md-4">
								<h5><b>Job UUID</b></h5>
							</div>
						</div>
					</button>
				</div>
				<br>
				<div class="row"> 
					<div class="col-md-9"></div>
					<button type="submit" class="btn btn-warning btn-lg col-md-3">Submit »</button>
				</div>
			</form>

		</div>
	</div>

	<div class="row align-items-center" style="padding-right: 15px; padding-left: 15px;">
		<div class="col-md-1"></div>
		<div class="col-md-10">
			<h2 class="text-center"><b>Status Report</b></h2>
			<hr>
		</div>
		<div class="col-md-1"></div>
		<br>
		{% if user %}
		<div class="row">
			<div class="col-md-1"></div>
			<div class="col-md-10">
				<h4>Hello user: <b>{{user.email}}</b>, your UUID is: <b>{{user.uuid}}</b></h4>
			</div>
			<div class="col-md-1"></div>

			<div class="col-md-1"></div>
			<div class="col-md-10">
				<h4>{% if user.job_status %}Your Job: <b>has been completed.</b>{% else %}Your Job: <b>is still running</b>, please come back later. We'll send an email when the job is done.{% endif %}</h4>
			</div>
			<div class="col-md-1"></div>

			<div class="col-md-1"></div>
			<div class="col-md-10">
				<h4>Please click on individual buttons to see results.</h4>
				<hr>
			</div>
			<div class="col-md-1"></div>
		</div>
		{% endif %}


	</div>
	<br><br>
	<div class="row align-items-center" style="padding-right: 15px; padding-left: 15px;">
		<div class="col-md-3 text-center">
			<button class="btn {% if not assembly %} btn-secondary {% else %} btn-primary {% endif %} align-items-center" type="button" data-toggle="collapse" data-target="#assembly" aria-expanded="false" aria-controls="assembly">Genome Assembly</button>
		</div>
		<div class="col-md-3 text-center">
			<button class="btn {% if not prediction %} btn-secondary {% else %} btn-primary {% endif %} align-items-center" type="button" data-toggle="collapse" data-target="#prediction" aria-expanded="false" aria-controls="prediction">Gene Prediciton</button>
		</div>
		<div class="col-md-3 text-center">
			<button class="btn {% if not annotation %} btn-secondary {% else %} btn-primary {% endif %} align-items-center" type="button" data-toggle="collapse" data-target="#annotation" aria-expanded="false" aria-controls="annotation">Functional Annotation</button>
		</div>
		<div class="col-md-3 text-center">
			<button class="btn {% if not comparative %} btn-secondary {% else %} btn-primary {% endif %} align-items-center" type="button" data-toggle="collapse" data-target="#comparative" aria-expanded="false" aria-controls="comparative" >Comparative Genomics</button>
		</div>
	</div>
	<br><br>
	<div class="collapse" id="assembly" style="padding-right: 15px; padding-left: 15px;">
		
		{% if not assembly %}

			<div class="card card-body">
				Information for Genome Assembly jobs. If you're seeing this message, that means that the job is still running, please check back later.
			</div>

		{% else %}
			<div class="card card-body">
				<div class="container">
					<div class="col-md-10">
						<div class="row">
							<h4 class="col-md-8">You have {{number_of_contig_files}} contig files generated by our pipeline »</h4>
							<form class="col-md-4" method="post" enctype="multipart/form-data" action="{% url 'download_contig_files' %}">
								{% csrf_token %}
								<input type="text" name="uuid" class="form-control" value="{{user.uuid}}" hidden>
								<button type="submit" class="btn btn-success">Download</button>
							</form>
						</div>
					</div>
					<div class="col-md-2"></div>
					
					<br><br>

					<div class="album py-5 bg-light">
						<div class="container">

						<div class="row">
							<div class="col-md-1"></div>
							<div class="col-md-10">
								<div class="card mb-4 shadow-sm">
								<img src="{% static 'images/jejuni-3.jpg' %}">
								
								<div class="card-body">
									<p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
								</div>
							</div>
							<div class="col-md-1"></div>
						</div>
						</div>
  					
  					</div>
				</div>


				<br><br>
			</div>
		{% endif %}
	</div>
	<div class="collapse" id="prediction" style="padding-right: 15px; padding-left: 15px;">
		<div class="card card-body">
			Information for Gene Prediction jobs. If you're seeing this message, that means that the job is still running, please check back later.
		</div>
	</div>
	<div class="collapse" id="annotation" style="padding-right: 15px; padding-left: 15px;">
		<div class="card card-body">
			Information for Functional Annotation jobs. If you're seeing this message, that means that the job is still running, please check back later.
		</div>
	</div>
	<div class="collapse" id="comparative" style="padding-right: 15px; padding-left: 15px;">
		<div class="card card-body">
			Information for Comparative Genomics jobs. If you're seeing this message, that means that the job is still running, please check back later.
		</div>
	</div>
	<br><br><br><br>

</main>

{% endblock %}